/* Home Run is a game where you must fill up a meter within the time limit by mashing buttons
as quickly as you can.  Once time is up, a ball is struck and sent flying. Its distance
depends on the power meter. */

package  
{
	import flash.display.MovieClip;
	import flash.events.KeyboardEvent;
	import flash.ui.Keyboard;
	import flash.events.Event;
	import flash.display.DisplayObject;
	import flash.display.Graphics;
    import flash.display.JointStyle;
    import flash.display.LineScaleMode;
    import flash.display.Shape;
    import flash.display.Sprite;
	import flash.text.TextField;
	import flash.text.TextFormat;
	
	
	public class Main extends MovieClip
	{
		//timer variables
		var _timer:Clock;
		var _timerText:TextField;
		var _timerFormat:TextFormat;
		var _secs:uint = 10;	//clock time
				
		var _player:Shape;
		var _ball:Shape;		//the object that'll go flying
		var _emptyBar:Shape;	//power gauge. Always fixed
		var _powerBar:Shape;	//fills up as you mash buttons
		var _ground:Shape;		//ball should bounce off of this
		
		
		var _pBarWidth:Number = 0;	//increases as buttons are pressed, decreases otherwise
		
		
		//HUD text
		var _instructionText:TextField;	//tells player what must be done
		var _barLabel:TextField;		//gauge label
		var _timeLabel:TextField;		//timer label

		public function Main() 
		{
			//timer information
			_timer = new Clock(_secs);
			
			_timerFormat = new TextFormat();
			_timerFormat.size = 50;
			_timerFormat.bold = true;
			_timerFormat.font = "Calibri";
			
			_timerText = new TextField();
			_timerText.defaultTextFormat = _timerFormat;
			_timerText.textColor = 0x0000F0;
			_timerText.width = 160;
			_timerText.height = 80;
			_timerText.x = 450;
			_timerText.y = 200;
			
			//display time and append zeroes where necessary
			if (_timer.Seconds() < 10)
			{
				_timerText.text = _timer.Minutes() + ":0" + _timer.Seconds() + ":" + _timer.Milliseconds();
			}
			else
			{
				_timerText.text = _timer.Minutes() + ":" + _timer.Seconds() + ":" + _timer.Milliseconds();
			}
			
						
			//instruction
			_instructionText = new TextField();

			_instructionText.textColor = 0x000000;
			_instructionText.defaultTextFormat = _timerFormat;
			_instructionText.x = 100;
			_instructionText.y = 50;
			_instructionText.width = 800;
			_instructionText.height = 150;
			_instructionText.multiline = true;
			_instructionText.wordWrap = true;
			_instructionText.text = "Mash the A and D keys to gather power!";
			
			//player
			_player = new Shape();
			_player.graphics.beginFill(0x0000cc);
			_player.graphics.drawRect(100, 500, 50, 50);
			_player.graphics.endFill();
			
			//ball
			_ball = new Shape();
			_ball.graphics.beginFill(0xcccccc);
			_ball.graphics.drawCircle(150, 500, 10);
			_ball.graphics.endFill();
			
			//lifebar label
			_wordText = new TextField();
			_wordText.defaultTextFormat = _timerFormat;
			_wordText.text = _targetWords[_currentWord];
			_wordText.textColor = 0x004400;
			_wordText.x = 440;
			_wordText.y = 500;
			_wordText.width = 200;
			_wordText.height = 70;
			

			
			addChild(_timerText);
			addChild(_instructionText);
			addChild(_wordText);
			
			addChild(_ball);
			addChild(_player);
			
			
			addEventListener(Event.ENTER_FRAME, onEnterFrame);
			stage.addEventListener(KeyboardEvent.KEY_DOWN, onKeyDown);
		}
		
		public function onKeyDown(event:KeyboardEvent):void
		{
			/*When ENTER is pressed, the game checks what was typed against
			the target word.  If correct, the next word is selected.
			Otherwise, the text box is cleared.*/
			
			switch (event.keyCode)
			{
				
			}
		}
		
		function onEnterFrame(event:Event):void
		{
			
			
			/* Time continually decreases until it reaches 0 or player completes all words. */
			_timer.Countdown();
			
						
						
			//update the timer
			if (_timer.Seconds() < 10 && _timer.Milliseconds() < 10)
			{
				_timerText.text = _timer.Minutes() + ":0" + _timer.Seconds() + ":0" + _timer.Milliseconds();
			}
			else if (_timer.Seconds() < 10 && _timer.Milliseconds() > 10)
			{
				_timerText.text = _timer.Minutes() + ":0" + _timer.Seconds() + ":" + _timer.Milliseconds();
			}
			else if (_timer.Seconds() > 10 && _timer.Milliseconds() < 10)
			{
				_timerText.text = _timer.Minutes() + ":" + _timer.Seconds() + ":0" + _timer.Milliseconds();
			}
			else
			{
				_timerText.text = _timer.Minutes() + ":" + _timer.Seconds() + ":" + _timer.Milliseconds();
			}
		}

	}
	
}
